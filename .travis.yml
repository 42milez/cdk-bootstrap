language: node_js
node_js:
  - stable
  - lts/*
matrix:
  fast_finish: true
cache:
  directories:
    - node_modules
git:
  depth: 1
  submodules: false
install:
  # Install bats ( https://github.com/mikefarah/yq#on-ubuntu-1604-or-higher-from-debian-package )
  - sudo add-apt-repository -y ppa:duggan/bats
  - sudo apt-get update
  - sudo apt-get install -y bats
  # Install yq ( https://github.com/mikefarah/yq#on-ubuntu-1604-or-higher-from-debian-package )
  - sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys CC86BB64
  - sudo add-apt-repository -y ppa:rmescandon/yq
  - sudo apt update
  - sudo apt install -y yq
  # Install Node Packages
  - npm ci
before_script:
  # check bash
  - type bash
  - bash --version
  # check jq
  - type jq
  - jq --version
  # check npm
  - type npm
  - npm --version
  # check npx
  - type npx
  - npx --version
  # check yq
  - type yq
  - yq --version
  # check code style
  - ./cmd/code.sh lint
  # build
  - ./cmd/code.sh build
script:
  - ./cmd/code.sh test
